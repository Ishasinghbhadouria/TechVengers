<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Timetable Input - Smart Scheduler</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <script>
        function addSubjectRow() {
            const container = document.getElementById('subjects-container');
            const index = container.children.length;
            const row = document.createElement('div');
            row.className = 'subject-row';
            row.innerHTML = `
                <input type="text" name="subjects[]" placeholder="Subject Name" required />
                <input type="number" name="classes_per_week[]" min="1" placeholder="Classes/Week" required />
                <input type="text" name="faculties[]" placeholder="Faculty Name" required />
                <button type="button" onclick="this.parentElement.remove()">Remove</button>
            `;
            container.appendChild(row);
            document.getElementById('num_subjects').value = container.children.length;
        }
        function updateNumSubjects() {
            const container = document.getElementById('subjects-container');
            document.getElementById('num_subjects').value = container.children.length;
        }
        window.onload = function() {
            addSubjectRow(); // Add one row by default
        }
    </script>
</head>
<body>
    <div class="container">
        <h2>Input Timetable Parameters</h2>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <ul class="flashes">
                {% for category, message in messages %}
                <li class="flash {{ category }}">{{ message }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        {% endwith %}
        <form method="POST" action="{{ url_for('timetable') }}">
            <label>Number of Classrooms</label>
            <input type="number" name="num_classrooms" min="1" required placeholder="e.g. 5" />
            <label>Number of Batches</label>
            <input type="number" name="num_batches" min="1" required placeholder="e.g. 3" />
            <label>Maximum Classes Per Day</label>
            <input type="number" name="max_classes_per_day" min="1" max="10" required placeholder="e.g. 6" />
            <input type="hidden" id="num_subjects" name="num_subjects" value="0" />
            <h3>Subjects</h3>
            <div id="subjects-container"></div>
            <button type="button" onclick="addSubjectRow()">Add Subject</button>
            <br /><br />
            <button type="submit">Generate Timetable</button>
        </form>
        <br />
        <a href="{{ url_for('dashboard') }}">Back to Dashboard</a>
    </div>
</body>
</html>